{"ast":null,"code":"import _toConsumableArray from\"/home/tom/Projects/FastAPI+React_Flowchart-Maker/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/tom/Projects/FastAPI+React_Flowchart-Maker/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useRef}from'react';import{Handle,Position}from'reactflow';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var TextNode=function TextNode(_ref){var id=_ref.id,data=_ref.data;var _useState=useState((data===null||data===void 0?void 0:data.text)||'{{input}}'),_useState2=_slicedToArray(_useState,2),textValue=_useState2[0],setTextValue=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),variables=_useState4[0],setVariables=_useState4[1];var _useState5=useState(140),_useState6=_slicedToArray(_useState5,2),nodeHeight=_useState6[0],setNodeHeight=_useState6[1];var textRef=useRef(null);//Parse {{variables}} from text\nuseEffect(function(){var regex=/\\{\\{\\s*([a-zA-Z_$][a-zA-Z0-9_$]*)\\s*\\}\\}/g;var found=Array.from(textValue.matchAll(regex)).map(function(m){return m[1];});setVariables(_toConsumableArray(new Set(found)));},[textValue]);useEffect(function(){var el=textRef.current;if(el){var prevScrollY=el.scrollTop;el.style.height='auto';var targetHeight=Math.min(Math.max(60,el.scrollHeight),240);el.style.height=\"\".concat(targetHeight,\"px\");var totalHeight=targetHeight+90;if(Math.abs(totalHeight-nodeHeight)>5)setNodeHeight(totalHeight);el.scrollTop=prevScrollY;}},[textValue]);return/*#__PURE__*/_jsxs(\"div\",{className:\"vs-node\",style:{width:280,height:nodeHeight,position:'relative',transition:'height 0.2s ease'},children:[variables.map(function(v,i){return/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',top:\"\".concat((i+1)*(100/(variables.length+1)),\"%\"),left:'-50px',display:'flex',alignItems:'center',justifyContent:'flex-end',width:'45px',gap:'6px',transform:'translateY(-50%)',pointerEvents:'none'},children:[/*#__PURE__*/_jsx(\"span\",{style:{color:'#a1a1aa',fontSize:11,fontFamily:'Inter, monospace',background:'#1f1f29',borderRadius:4,padding:'1px 4px',whiteSpace:'nowrap',pointerEvents:'none'},children:v}),/*#__PURE__*/_jsx(Handle,{type:\"target\",position:Position.Left,id:\"\".concat(id,\"-\").concat(v),style:{left:46,background:'var(--vs-handle)',pointerEvents:'auto'}})]},v);}),/*#__PURE__*/_jsx(Handle,{type:\"source\",position:Position.Right,id:\"\".concat(id,\"-output\"),style:{top:'50%'}}),/*#__PURE__*/_jsx(\"div\",{className:\"vs-node__title\",children:\"Text\"}),/*#__PURE__*/_jsxs(\"label\",{className:\"vs-label\",style:{flex:1},children:[\"Text:\",/*#__PURE__*/_jsx(\"textarea\",{ref:textRef,className:\"vs-input\",value:textValue,onChange:function onChange(e){return setTextValue(e.target.value);},style:{resize:'none',width:'100%',lineHeight:1.5,overflowY:'hidden',background:'#2a2a34'}})]})]});};","map":{"version":3,"names":["useState","useEffect","useRef","Handle","Position","jsx","_jsx","jsxs","_jsxs","TextNode","_ref","id","data","_useState","text","_useState2","_slicedToArray","textValue","setTextValue","_useState3","_useState4","variables","setVariables","_useState5","_useState6","nodeHeight","setNodeHeight","textRef","regex","found","Array","from","matchAll","map","m","_toConsumableArray","Set","el","current","prevScrollY","scrollTop","style","height","targetHeight","Math","min","max","scrollHeight","concat","totalHeight","abs","className","width","position","transition","children","v","i","top","length","left","display","alignItems","justifyContent","gap","transform","pointerEvents","color","fontSize","fontFamily","background","borderRadius","padding","whiteSpace","type","Left","Right","flex","ref","value","onChange","e","target","resize","lineHeight","overflowY"],"sources":["/home/tom/Projects/FastAPI+React_Flowchart-Maker/frontend/src/nodes/textNode.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\nimport { Handle, Position } from 'reactflow';\n\nexport const TextNode = ({ id, data }) => {\n  const [textValue, setTextValue] = useState(data?.text || '{{input}}');\n  const [variables, setVariables] = useState([]);\n  const [nodeHeight, setNodeHeight] = useState(140);\n  const textRef = useRef(null);\n\n  //Parse {{variables}} from text\n  useEffect(() => {\n    const regex = /\\{\\{\\s*([a-zA-Z_$][a-zA-Z0-9_$]*)\\s*\\}\\}/g;\n    const found = Array.from(textValue.matchAll(regex)).map((m) => m[1]);\n    setVariables([...new Set(found)]);\n  }, [textValue]);\n\n  useEffect(() => {\n    const el = textRef.current;\n    if (el) {\n      const prevScrollY = el.scrollTop;\n      el.style.height = 'auto';\n      const targetHeight = Math.min(Math.max(60, el.scrollHeight), 240);\n      el.style.height = `${targetHeight}px`;\n      const totalHeight = targetHeight + 90;\n      if (Math.abs(totalHeight - nodeHeight) > 5) setNodeHeight(totalHeight);\n      el.scrollTop = prevScrollY;\n    }\n  }, [textValue]);\n\n  return (\n    <div\n      className=\"vs-node\"\n      style={{\n        width: 280,\n        height: nodeHeight,\n        position: 'relative',\n        transition: 'height 0.2s ease',\n      }}\n    >\n      {/* Variable handles + labels */}\n      {variables.map((v, i) => (\n        <div\n          key={v}\n          style={{\n            position: 'absolute',\n            top: `${(i + 1) * (100 / (variables.length + 1))}%`,\n            left: '-50px',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'flex-end',\n            width: '45px',\n            gap: '6px',\n            transform: 'translateY(-50%)',\n            pointerEvents: 'none', \n          }}\n        >\n          <span\n            style={{\n              color: '#a1a1aa',\n              fontSize: 11,\n              fontFamily: 'Inter, monospace',\n              background: '#1f1f29',\n              borderRadius: 4,\n              padding: '1px 4px',\n              whiteSpace: 'nowrap',\n              pointerEvents: 'none',\n            }}\n          >\n            {v}\n          </span>\n          <Handle\n            type=\"target\"\n            position={Position.Left}\n            id={`${id}-${v}`}\n            style={{\n              left: 46,\n              background: 'var(--vs-handle)',\n              pointerEvents: 'auto',\n            }}\n          />\n        </div>\n      ))}\n\n      {/* Output handle */}\n      <Handle\n        type=\"source\"\n        position={Position.Right}\n        id={`${id}-output`}\n        style={{ top: '50%' }}\n      />\n\n      {/* Header */}\n      <div className=\"vs-node__title\">Text</div>\n\n      {/* Text area */}\n      <label className=\"vs-label\" style={{ flex: 1 }}>\n        Text:\n        <textarea\n          ref={textRef}\n          className=\"vs-input\"\n          value={textValue}\n          onChange={(e) => setTextValue(e.target.value)}\n          style={{\n            resize: 'none',\n            width: '100%',\n            lineHeight: 1.5,\n            overflowY: 'hidden',\n            background: '#2a2a34',\n          }}\n        />\n      </label>\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}