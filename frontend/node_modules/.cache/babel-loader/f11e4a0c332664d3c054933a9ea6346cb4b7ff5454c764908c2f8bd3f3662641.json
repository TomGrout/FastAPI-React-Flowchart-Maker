{"ast":null,"code":"import _regeneratorRuntime from\"/home/tom/Projects/FastAPI+React_Flowchart-Maker/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/tom/Projects/FastAPI+React_Flowchart-Maker/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/tom/Projects/FastAPI+React_Flowchart-Maker/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// ui.js\n// Displays the drag-and-drop UI\n// --------------------------------------------------\nimport{useState,useRef,useCallback}from'react';import ReactFlow,{Controls,Background,MiniMap}from'reactflow';import{useStore}from'./store';import{shallow}from'zustand/shallow';import{InputNode}from'./nodes/inputNode';import{LLMNode}from'./nodes/llmNode';import{OutputNode}from'./nodes/outputNode';import{TextNode}from'./nodes/textNode';import'reactflow/dist/style.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var gridSize=20;var proOptions={hideAttribution:true};var nodeTypes={customInput:InputNode,llm:LLMNode,customOutput:OutputNode,text:TextNode};var selector=function selector(state){return{nodes:state.nodes,edges:state.edges,getNodeID:state.getNodeID,addNode:state.addNode,onNodesChange:state.onNodesChange,onEdgesChange:state.onEdgesChange,onConnect:state.onConnect};};export var PipelineUI=function PipelineUI(){var reactFlowWrapper=useRef(null);var _useState=useState(null),_useState2=_slicedToArray(_useState,2),reactFlowInstance=_useState2[0],setReactFlowInstance=_useState2[1];var _useStore=useStore(selector,shallow),nodes=_useStore.nodes,edges=_useStore.edges,getNodeID=_useStore.getNodeID,addNode=_useStore.addNode,onNodesChange=_useStore.onNodesChange,onEdgesChange=_useStore.onEdgesChange,onConnect=_useStore.onConnect;var getInitNodeData=function getInitNodeData(nodeID,type){var nodeData={id:nodeID,nodeType:\"\".concat(type)};return nodeData;};var onDrop=useCallback(function(event){var _event$dataTransfer;event.preventDefault();var reactFlowBounds=reactFlowWrapper.current.getBoundingClientRect();if(event!==null&&event!==void 0&&(_event$dataTransfer=event.dataTransfer)!==null&&_event$dataTransfer!==void 0&&_event$dataTransfer.getData('application/reactflow')){var appData=JSON.parse(event.dataTransfer.getData('application/reactflow'));var type=appData===null||appData===void 0?void 0:appData.nodeType;// check if the dropped element is valid\nif(typeof type==='undefined'||!type)return;var position=reactFlowInstance.project({x:event.clientX-reactFlowBounds.left,y:event.clientY-reactFlowBounds.top});var nodeID=getNodeID(type);var newNode={id:nodeID,type:type,position:position,data:getInitNodeData(nodeID,type)};addNode(newNode);}},[reactFlowInstance]);var onDragOver=useCallback(function(event){event.preventDefault();event.dataTransfer.dropEffect='move';},[]);// ‚úÖ Backend submission logic\nvar handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch('http://localhost:8000/pipelines/parse',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({nodes:nodes,edges:edges})});case 3:response=_context.sent;if(response.ok){_context.next=6;break;}throw new Error(\"Server error: \".concat(response.status));case 6:_context.next=8;return response.json();case 8:result=_context.sent;alert(\"Pipeline Analysis:\\n\\n\"+\"\\uD83E\\uDDE9 Nodes: \".concat(result.num_nodes,\"\\n\")+\"\\uD83D\\uDD17 Edges: \".concat(result.num_edges,\"\\n\")+\"\\u2705 Is DAG: \".concat(result.is_dag?'Yes ‚úÖ':'No ‚ùå'));_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.error('Error submitting pipeline:',_context.t0);alert('‚ùå Failed to submit pipeline. Check console for details.');case 16:case\"end\":return _context.stop();}},_callee,null,[[0,12]]);}));return function handleSubmit(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{ref:reactFlowWrapper,style:{width:'100vw',height:'70vh'},children:/*#__PURE__*/_jsxs(ReactFlow,{nodes:nodes,edges:edges,onNodesChange:onNodesChange,onEdgesChange:onEdgesChange,onConnect:onConnect,onDrop:onDrop,onDragOver:onDragOver,onInit:setReactFlowInstance,nodeTypes:nodeTypes,proOptions:proOptions,snapGrid:[gridSize,gridSize],connectionLineType:\"smoothstep\",fitView:true,style:{background:'var(--vs-bg)'},children:[/*#__PURE__*/_jsx(Background,{color:\"rgba(255,255,255,0.05)\",gap:16}),/*#__PURE__*/_jsx(Controls,{style:{background:'var(--vs-node-bg)',borderRadius:8}}),/*#__PURE__*/_jsx(MiniMap,{})]})}),/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',marginTop:'20px'},children:/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,children:\"Submit Pipeline\"})})]});};","map":{"version":3,"names":["useState","useRef","useCallback","ReactFlow","Controls","Background","MiniMap","useStore","shallow","InputNode","LLMNode","OutputNode","TextNode","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","gridSize","proOptions","hideAttribution","nodeTypes","customInput","llm","customOutput","text","selector","state","nodes","edges","getNodeID","addNode","onNodesChange","onEdgesChange","onConnect","PipelineUI","reactFlowWrapper","_useState","_useState2","_slicedToArray","reactFlowInstance","setReactFlowInstance","_useStore","getInitNodeData","nodeID","type","nodeData","id","nodeType","concat","onDrop","event","_event$dataTransfer","preventDefault","reactFlowBounds","current","getBoundingClientRect","dataTransfer","getData","appData","JSON","parse","position","project","x","clientX","left","y","clientY","top","newNode","data","onDragOver","dropEffect","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","result","wrap","_callee$","_context","prev","next","fetch","method","headers","body","stringify","sent","ok","Error","status","json","alert","num_nodes","num_edges","is_dag","t0","console","error","stop","apply","arguments","children","ref","style","width","height","onInit","snapGrid","connectionLineType","fitView","background","color","gap","borderRadius","textAlign","marginTop","onClick"],"sources":["/home/tom/Projects/FastAPI+React_Flowchart-Maker/frontend/src/ui.js"],"sourcesContent":["// ui.js\n// Displays the drag-and-drop UI\n// --------------------------------------------------\n\nimport { useState, useRef, useCallback } from 'react';\nimport ReactFlow, { Controls, Background, MiniMap } from 'reactflow';\nimport { useStore } from './store';\nimport { shallow } from 'zustand/shallow';\nimport { InputNode } from './nodes/inputNode';\nimport { LLMNode } from './nodes/llmNode';\nimport { OutputNode } from './nodes/outputNode';\nimport { TextNode } from './nodes/textNode';\n\nimport 'reactflow/dist/style.css';\n\nconst gridSize = 20;\nconst proOptions = { hideAttribution: true };\nconst nodeTypes = {\n  customInput: InputNode,\n  llm: LLMNode,\n  customOutput: OutputNode,\n  text: TextNode,\n};\n\nconst selector = (state) => ({\n  nodes: state.nodes,\n  edges: state.edges,\n  getNodeID: state.getNodeID,\n  addNode: state.addNode,\n  onNodesChange: state.onNodesChange,\n  onEdgesChange: state.onEdgesChange,\n  onConnect: state.onConnect,\n});\n\nexport const PipelineUI = () => {\n  const reactFlowWrapper = useRef(null);\n  const [reactFlowInstance, setReactFlowInstance] = useState(null);\n  const {\n    nodes,\n    edges,\n    getNodeID,\n    addNode,\n    onNodesChange,\n    onEdgesChange,\n    onConnect,\n  } = useStore(selector, shallow);\n\n  const getInitNodeData = (nodeID, type) => {\n    let nodeData = { id: nodeID, nodeType: `${type}` };\n    return nodeData;\n  };\n\n  const onDrop = useCallback(\n    (event) => {\n      event.preventDefault();\n\n      const reactFlowBounds = reactFlowWrapper.current.getBoundingClientRect();\n      if (event?.dataTransfer?.getData('application/reactflow')) {\n        const appData = JSON.parse(event.dataTransfer.getData('application/reactflow'));\n        const type = appData?.nodeType;\n\n        // check if the dropped element is valid\n        if (typeof type === 'undefined' || !type) return;\n\n        const position = reactFlowInstance.project({\n          x: event.clientX - reactFlowBounds.left,\n          y: event.clientY - reactFlowBounds.top,\n        });\n\n        const nodeID = getNodeID(type);\n        const newNode = {\n          id: nodeID,\n          type,\n          position,\n          data: getInitNodeData(nodeID, type),\n        };\n\n        addNode(newNode);\n      }\n    },\n    [reactFlowInstance]\n  );\n\n  const onDragOver = useCallback((event) => {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n  }, []);\n\n  // ‚úÖ Backend submission logic\n  const handleSubmit = async () => {\n    try {\n      const response = await fetch('http://localhost:8000/pipelines/parse', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ nodes, edges }),\n      });\n\n      if (!response.ok) throw new Error(`Server error: ${response.status}`);\n\n      const result = await response.json();\n\n      alert(\n        `Pipeline Analysis:\\n\\n` +\n          `üß© Nodes: ${result.num_nodes}\\n` +\n          `üîó Edges: ${result.num_edges}\\n` +\n          `‚úÖ Is DAG: ${result.is_dag ? 'Yes ‚úÖ' : 'No ‚ùå'}`\n      );\n    } catch (err) {\n      console.error('Error submitting pipeline:', err);\n      alert('‚ùå Failed to submit pipeline. Check console for details.');\n    }\n  };\n\n  return (\n    <>\n      <div ref={reactFlowWrapper} style={{ width: '100vw', height: '70vh' }}>\n        <ReactFlow\n          nodes={nodes}\n          edges={edges}\n          onNodesChange={onNodesChange}\n          onEdgesChange={onEdgesChange}\n          onConnect={onConnect}\n          onDrop={onDrop}\n          onDragOver={onDragOver}\n          onInit={setReactFlowInstance}\n          nodeTypes={nodeTypes}\n          proOptions={proOptions}\n          snapGrid={[gridSize, gridSize]}\n          connectionLineType=\"smoothstep\"\n          fitView\n          style={{ background: 'var(--vs-bg)' }}\n        >\n          <Background color=\"rgba(255,255,255,0.05)\" gap={16} />\n          <Controls style={{ background: 'var(--vs-node-bg)', borderRadius: 8 }} />\n          <MiniMap />\n        </ReactFlow>\n      </div>\n\n      {/* Submit button */}\n      <div style={{ textAlign: 'center', marginTop: '20px' }}>\n        <button onClick={handleSubmit}>Submit Pipeline</button>\n      </div>\n    </>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}